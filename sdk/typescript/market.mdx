---
title: Market
description: 'Load and query market state'
---

# Market Operations

## Load a Market

```typescript
import { createSolanaRpc, address } from '@solana/kit';
import { Market } from '@braid/client';

const rpc = createSolanaRpc('https://api.mainnet-beta.solana.com');
const market = new Market(rpc, address('...'));

// Fetch market data
const state = await market.fetch();
```

## Market Properties

After fetching, access data through `state.data`:

```typescript
const state = await market.fetch();

// Token mints
state.data.mintA        // Base token mint
state.data.mintB        // Quote token mint

// Vaults
state.data.orderbookVaultA   // Base token vault
state.data.orderbookVaultB   // Quote token vault

// Configuration
state.data.clmmFeeBps   // CLMM taker fee (basis points)
state.data.limitFeeBps  // Limit order taker fee
state.data.isPaused     // Whether trading is paused
```

## Fetch Orderbook

```typescript
// Fetch all orders across all sources in one call
const orders = await market.fetchAllOrders();

// Iterate through limit bids (highest price first)
for (const bid of orders.limitBids.iterateBids()) {
  console.log(`Limit Bid: ${bid.base.amountRemaining} @ ${bid.priceNode.key.price}`);
}

// Iterate through limit asks (lowest price first)
for (const ask of orders.limitAsks.iterateAsks()) {
  console.log(`Limit Ask: ${ask.base.amountRemaining} @ ${ask.priceNode.key.price}`);
}

// Iterate through CLMM positions
for (const position of orders.clmmBids.iterateBids()) {
  console.log(`CLMM: ${position.base.amountRemaining} in range`);
}

// Or fetch individual shard types using shard fetchers
const bidShards = await market.limitBids.fetchAllShards();
const askShards = await market.limitAsks.fetchAllShards();
```

## Load Market by Address

```typescript
import { createSolanaRpc, address } from '@solana/kit';
import { Market } from '@braid/client';

const rpc = createSolanaRpc('https://api.mainnet-beta.solana.com');

// Load market by address
const market = new Market(rpc, address('...'));
const state = await market.fetch();

// Or check if market exists first
const maybeState = await market.fetchMaybe();
if (maybeState) {
  console.log('Market exists');
}
```

## Derive Market Address

```typescript
import { address } from '@solana/kit';
import { Market } from '@braid/client';

// Derive market PDA from token mints and seed
const marketPda = await Market.deriveAddress(
  address('MintA...'),  // Base token mint
  address('MintB...'),  // Quote token mint
  new Uint8Array(8),    // 8-byte seed for uniqueness (optional)
);
```
